\documentclass{report}

\usepackage[magyar]{babel}
\usepackage{ifxetex}
\ifxetex
  \usepackage{fontspec}
  \usepackage{listingsutf8}
  \makeatletter
  \lst@InputCatcodes
  \include{xelatex-characters}
  \lst@RestoreCatcodes
  \makeatother
\else
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{lmodern}
  \usepackage{listings}
  \lstset{
    literate=*
        {á}{{\'a}}1
        {é}{{\'e}}1
        {í}{{\'i}}1
        {ó}{{\'o}}1
        {ö}{{\"o}}1
        {ő}{{\H{o}}}1
        {ú}{{\'u}}1
        {ü}{{\"u}}1
        {ű}{{\H{u}}}1
        {Á}{{\'A}}1
        {É}{{\'E}}1
        {Í}{{\'I}}1
        {Ó}{{\'O}}1
        {Ö}{{\"O}}1
        {Ő}{{\H{O}}}1
        {Ú}{{\'U}}1
        {Ü}{{\"U}}1
        {Ű}{{\H{U}}}1
}
\fi

\lstset{
    basicstyle=\ttfamily,
    keepspaces=true,
    columns=flexible, % only use with keepspaces=true       
}

\begin{document}

% for PDFLaTeX
\begin{lstlisting}
árvíztűrő tükörfúrógép á é í ó ö ő ú ü ű
ÁRVÍZTŰRŐ TÜKÖRFÚRÓGÉP Á É Í Ó Ö Ő Ú Ü Ű
\end{lstlisting}

\end{document}